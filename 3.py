data = {
  "currentCount": 340,
  "data": [
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "51.310",
      "남성인구수": 24856,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.150",
      "세대수": 22574,
      "여성구성비": "48.690",
      "여성인구수": 23587,
      "읍면동명": "문산읍",
      "총인구수": 48443,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "50.430",
      "남성인구수": 13850,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.200",
      "세대수": 12457,
      "여성구성비": "49.570",
      "여성인구수": 13616,
      "읍면동명": "조리읍",
      "총인구수": 27466,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.210",
      "남성인구수": 4899,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.780",
      "세대수": 5174,
      "여성구성비": "46.790",
      "여성인구수": 4308,
      "읍면동명": "법원읍",
      "총인구수": 9207,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.270",
      "남성인구수": 7177,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.790",
      "세대수": 7536,
      "여성구성비": "46.730",
      "여성인구수": 6296,
      "읍면동명": "파주읍",
      "총인구수": 13473,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.830",
      "남성인구수": 5551,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.820",
      "세대수": 5564,
      "여성구성비": "45.170",
      "여성인구수": 4573,
      "읍면동명": "광탄면",
      "총인구수": 10124,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.760",
      "남성인구수": 7411,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.840",
      "세대수": 7503,
      "여성구성비": "46.240",
      "여성인구수": 6374,
      "읍면동명": "탄현면",
      "총인구수": 13785,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "64.880",
      "남성인구수": 5116,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.370",
      "세대수": 5750,
      "여성구성비": "35.120",
      "여성인구수": 2769,
      "읍면동명": "월롱면",
      "총인구수": 7885,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.500",
      "남성인구수": 3545,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.890",
      "세대수": 3444,
      "여성구성비": "45.500",
      "여성인구수": 2959,
      "읍면동명": "적성면",
      "총인구수": 6504,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "52.830",
      "남성인구수": 1829,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.780",
      "세대수": 1946,
      "여성구성비": "47.170",
      "여성인구수": 1633,
      "읍면동명": "파평면",
      "총인구수": 3462,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.420",
      "남성인구수": 382,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.190",
      "세대수": 320,
      "여성구성비": "45.580",
      "여성인구수": 320,
      "읍면동명": "장단면",
      "총인구수": 702,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.740",
      "남성인구수": 3810,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.890",
      "세대수": 3742,
      "여성구성비": "46.260",
      "여성인구수": 3280,
      "읍면동명": "교하동",
      "총인구수": 7090,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.980",
      "남성인구수": 26009,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.420",
      "세대수": 21919,
      "여성구성비": "51.020",
      "여성인구수": 27096,
      "읍면동명": "운정1동",
      "총인구수": 53105,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.450",
      "남성인구수": 30783,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.610",
      "세대수": 24301,
      "여성구성비": "51.550",
      "여성인구수": 32752,
      "읍면동명": "운정2동",
      "총인구수": 63535,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.770",
      "남성인구수": 33073,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.520",
      "세대수": 26922,
      "여성구성비": "51.230",
      "여성인구수": 34747,
      "읍면동명": "운정3동",
      "총인구수": 67820,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "49.130",
      "남성인구수": 11789,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.280",
      "세대수": 10543,
      "여성구성비": "50.870",
      "여성인구수": 12208,
      "읍면동명": "운정4동",
      "총인구수": 23997,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "49.860",
      "남성인구수": 28711,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.620",
      "세대수": 21957,
      "여성구성비": "50.140",
      "여성인구수": 28878,
      "읍면동명": "운정5동",
      "총인구수": 57589,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "50.150",
      "남성인구수": 15535,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.300",
      "세대수": 13463,
      "여성구성비": "49.850",
      "여성인구수": 15441,
      "읍면동명": "운정6동",
      "총인구수": 30976,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.010",
      "남성인구수": 11358,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.730",
      "세대수": 12176,
      "여성구성비": "45.990",
      "여성인구수": 9670,
      "읍면동명": "금촌1동",
      "총인구수": 21028,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.310",
      "남성인구수": 14590,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.380",
      "세대수": 12703,
      "여성구성비": "51.690",
      "여성인구수": 15610,
      "읍면동명": "금촌2동",
      "총인구수": 30200,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "50.710",
      "남성인구수": 12389,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.320",
      "세대수": 10540,
      "여성구성비": "49.290",
      "여성인구수": 12043,
      "읍면동명": "금촌3동",
      "총인구수": 24432,
      "통계연월": "2025-07"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "51.330",
      "남성인구수": 24833,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.150",
      "세대수": 22535,
      "여성구성비": "48.670",
      "여성인구수": 23550,
      "읍면동명": "문산읍",
      "총인구수": 48383,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "50.450",
      "남성인구수": 13849,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.200",
      "세대수": 12470,
      "여성구성비": "49.550",
      "여성인구수": 13601,
      "읍면동명": "조리읍",
      "총인구수": 27450,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.160",
      "남성인구수": 4885,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.780",
      "세대수": 5166,
      "여성구성비": "46.840",
      "여성인구수": 4304,
      "읍면동명": "법원읍",
      "총인구수": 9189,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.250",
      "남성인구수": 7135,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.780",
      "세대수": 7511,
      "여성구성비": "46.750",
      "여성인구수": 6265,
      "읍면동명": "파주읍",
      "총인구수": 13400,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.760",
      "남성인구수": 5514,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.810",
      "세대수": 5549,
      "여성구성비": "45.240",
      "여성인구수": 4556,
      "읍면동명": "광탄면",
      "총인구수": 10070,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.600",
      "남성인구수": 7451,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.840",
      "세대수": 7571,
      "여성구성비": "46.400",
      "여성인구수": 6450,
      "읍면동명": "탄현면",
      "총인구수": 13901,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "64.800",
      "남성인구수": 5056,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.370",
      "세대수": 5677,
      "여성구성비": "35.200",
      "여성인구수": 2747,
      "읍면동명": "월롱면",
      "총인구수": 7803,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.460",
      "남성인구수": 3552,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.890",
      "세대수": 3445,
      "여성구성비": "45.540",
      "여성인구수": 2970,
      "읍면동명": "적성면",
      "총인구수": 6522,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "52.760",
      "남성인구수": 1824,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.780",
      "세대수": 1940,
      "여성구성비": "47.240",
      "여성인구수": 1633,
      "읍면동명": "파평면",
      "총인구수": 3457,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.560",
      "남성인구수": 383,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.180",
      "세대수": 322,
      "여성구성비": "45.440",
      "여성인구수": 319,
      "읍면동명": "장단면",
      "총인구수": 702,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "53.790",
      "남성인구수": 3800,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.890",
      "세대수": 3732,
      "여성구성비": "46.210",
      "여성인구수": 3265,
      "읍면동명": "교하동",
      "총인구수": 7065,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.980",
      "남성인구수": 26285,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.420",
      "세대수": 22158,
      "여성구성비": "51.020",
      "여성인구수": 27377,
      "읍면동명": "운정1동",
      "총인구수": 53662,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.420",
      "남성인구수": 30721,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.610",
      "세대수": 24290,
      "여성구성비": "51.580",
      "여성인구수": 32720,
      "읍면동명": "운정2동",
      "총인구수": 63441,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.770",
      "남성인구수": 32993,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.520",
      "세대수": 26889,
      "여성구성비": "51.230",
      "여성인구수": 34663,
      "읍면동명": "운정3동",
      "총인구수": 67656,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "49.110",
      "남성인구수": 11789,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.280",
      "세대수": 10544,
      "여성구성비": "50.890",
      "여성인구수": 12215,
      "읍면동명": "운정4동",
      "총인구수": 24004,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "49.830",
      "남성인구수": 28747,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.620",
      "세대수": 21987,
      "여성구성비": "50.170",
      "여성인구수": 28942,
      "읍면동명": "운정5동",
      "총인구수": 57689,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "50.150",
      "남성인구수": 15865,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.300",
      "세대수": 13753,
      "여성구성비": "49.850",
      "여성인구수": 15770,
      "읍면동명": "운정6동",
      "총인구수": 31635,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "54.070",
      "남성인구수": 11325,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "1.720",
      "세대수": 12169,
      "여성구성비": "45.930",
      "여성인구수": 9622,
      "읍면동명": "금촌1동",
      "총인구수": 20947,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "48.320",
      "남성인구수": 14548,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.370",
      "세대수": 12687,
      "여성구성비": "51.680",
      "여성인구수": 15561,
      "읍면동명": "금촌2동",
      "총인구수": 30109,
      "통계연월": "2025-08"
    },
    {
      "관리기관명": "경기도 파주시청",
      "관리부서전화번호": "031-940-4202",
      "남성구성비": "50.720",
      "남성인구수": 12389,
      "데이터기준일자": "2025-09-04",
      "세대당인구수": "2.310",
      "세대수": 10557,
      "여성구성비": "49.280",
      "여성인구수": 12038,
      "읍면동명": "금촌3동",
      "총인구수": 24427,
      "통계연월": "2025-08"
    }
  ],
  "matchCount": 340,
  "page": 1,
  "perPage": 9999,
  "totalCount": 340
}

from collections import defaultdict

# 통계연월별 총인구수 합계 계산
trend = defaultdict(int)
ym_eupmyeondong = defaultdict(lambda: defaultdict(int))
for row in data["data"]:
    ym = row["통계연월"]
    name = row["읍면동명"]
    pop = row["총인구수"]
    trend[ym] += pop
    ym_eupmyeondong[ym][name] = pop

# 연월 오름차순 정렬
sorted_trend = sorted(trend.items())
sorted_ym = [ym for ym, _ in sorted_trend]

# 전월 대비 증감 표시
result = []
prev_total = None
for ym, total in sorted_trend:
    diff = None if prev_total is None else total - prev_total
    result.append((ym, total, diff))
    prev_total = total

# 전체 읍면동별, 그룹별 인구 집계 (최신월 기준)
latest_ym = sorted_ym[-1]
latest_rows = [row for row in data["data"] if row["통계연월"] == latest_ym]
total_population = sum(row["총인구수"] for row in latest_rows)
eupmyeondong_stats = defaultdict(int)
group_stats = defaultdict(int)
for row in latest_rows:
    name = row["읍면동명"]
    pop = row["총인구수"]
    group = "운정구" if "운정" in name or "교하" in name else "북파주"
    eupmyeondong_stats[name] += pop
    group_stats[group] += pop

# 동별 증감율 계산 (전월-당월)
diff_rate_list = []
for i in range(1, len(sorted_ym)):
    prev_ym = sorted_ym[i-1]
    curr_ym = sorted_ym[i]
    prev_pop = ym_eupmyeondong[prev_ym]
    curr_pop = ym_eupmyeondong[curr_ym]
    for name in curr_pop:
        if name in prev_pop and prev_pop[name] != 0:
            diff = curr_pop[name] - prev_pop[name]
            rate = diff / prev_pop[name] * 100
            diff_rate_list.append((curr_ym, name, diff, rate))
top5 = sorted(diff_rate_list, key=lambda x: abs(x[3]), reverse=True)[:5]

# 파주시 전체 총인구수 표시 (최신월 기준)
print(f"\n총인구수 {total_population:,}")

print(f"\n읍면동별:")

population = []
bukpaju = []
group = "운정구" if "운정" in name or "교하" in name else "북파주"

for name, pop in eupmyeondong_stats.items():
    ratio = pop / total_population * 100
    entry = (name, pop, ratio)
    population.append(entry)

for name, pop, ratio in sorted(population, key=lambda x: x[1], reverse=True):
    print(f"{name}: {pop:,} ({ratio:.2f}%)")

for name, pop, ratio in sorted(bukpaju, key=lambda x: x[1], reverse=True):
    print(f"{name}: {pop:,} ({ratio:.2f}%)")

print(f"\n인구 비율:")
for group, pop in group_stats.items():
    ratio = pop / total_population * 100
    print(f"{group}: {pop:,} ({ratio:.2f}%)")

print("\n증감율 상위 5개 동:")
for ym, name, diff, rate in top5:
    sign = "+" if diff >= 0 else ""
    print(f"{name}: {sign}{diff:,} ({sign}{rate:.2f}%)")

# 출력
for ym, total, diff in result:
    if diff is None:
        print(f"\n{ym}: {total:,} (기준월)")
    else:
        sign = "+" if diff >= 0 else ""
        print(f"{ym}: {total:,} ({sign}{diff:,})")